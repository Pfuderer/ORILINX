Bootstrap: docker
From: nvidia/cuda:13.1.0-devel-ubuntu24.04

%labels
    Version v1.0.1

%help
    ORILINX is software that detects the location of replication origins in mammalian genomes. 
    Source: https://github.com/Pfuderer/ORILINX
    Documentation: https://orilinx.readthedocs.io/en/latest/?badge=latest
    Web: https://www.boemogroup.org/
    Please submit any bugs to https://github.com/Pfuderer/ORILINX/issues.

%post

    TZ=Europe/London
    ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone
    apt update
    apt install -y tzdata

    # Install system packages
    apt-get update && apt-get install -y \
        build-essential \
        wget \
        git \
        python3 \
        python3-pip \

    # Clone and compile DNAscent
    mkdir -p /app
    cd app
    git clone --recursive https://github.com/MBoemo/DNAscent.git
    cd DNAscent
    make
    
%environment

    # cuda paths
    export CUDA_HOME=/usr/local/cuda
    export CPATH=/usr/local/cuda/include:$CPATH
    export CUDA_PATH=/usr/local/cuda
    export LIBRARY_PATH=/usr/local/cuda/lib64:$LIBRARY_PATH
    export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
    export PATH=/usr/local/cuda/bin:$PATH

%runscript
    exec orilinx "$@"